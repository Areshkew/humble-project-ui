<div class="container">
    <form class="edit-info__form" [formGroup]="editInfoForm" (ngSubmit)="onSubmit()">
        <p class="edit-msg">Editar informacion</p>
        <div class="form__group flex-container">
            <div class="form__data flex-container" style="--flex-direction: column">
                <div class="input__group">
                    <label>Nombres</label>
                    <input type="text" pInputText formControlName="nombre"
                    [ngClass]="{'lib-invalid': editInfoForm.get('nombre')?.touched && editInfoForm.get('nombre')?.invalid}">
                </div>
                <div class="input__group">
                    <label>Apellidos</label>
                    <input type="text" pInputText formControlName="apellido"
                    [ngClass]="{'lib-invalid': editInfoForm.get('apellido')?.touched && editInfoForm.get('apellido')?.invalid}">
                </div>
                <div class="input__group">
                    <label>Pais</label>
                    <p-dropdown [options]="countries" optionLabel="name" [filter]="true" (onChange)="onCountryChange()"
                        formControlName="pais"
                        [ngClass]="{'lib-invalid': editInfoForm.get('pais')?.touched && editInfoForm.get('pais')?.invalid}"></p-dropdown>
                </div>
                <div class="input__group">
                    <label>Estado</label>
                    <p-dropdown #stateDropdown [options]="states" optionLabel="name" [filter]="true"
                        (onChange)="onStateChange()" formControlName="estado"
                        [ngClass]="{'lib-invalid': editInfoForm.get('estado')?.touched && editInfoForm.get('estado')?.invalid}"></p-dropdown>
                </div>
                <div class="input__group">
                    <label>Ciudad</label>
                    <p-dropdown #cityDropdown [options]="cities" optionLabel="name" [filter]="true"
                        formControlName="ciudad"
                        [ngClass]="{'lib-invalid': editInfoForm.get('ciudad')?.touched && editInfoForm.get('ciudad')?.invalid}"></p-dropdown>
                </div>
            </div>
            <div class="form__data flex-container" style="--flex-direction: column">
                <div class="input__group">
                    <label>Direccion</label>
                    <input type="text" pInputText formControlName="direccion_envio"
                    [ngClass]="{'lib-invalid': editInfoForm.get('direccion_envio')?.touched && editInfoForm.get('direccion_envio')?.invalid}">
                </div>
                <div class="input__group">
                    <label>Genero</label>
                    <p-dropdown [options]="genres" formControlName="genero"
                    [ngClass]="{'lib-invalid': editInfoForm.get('genero')?.touched && editInfoForm.get('genero')?.invalid}"></p-dropdown>
                </div>
                <div class="input__group">
                    <label>Nacimiento</label>
                    <p-calendar formControlName="fecha_nacimiento" [defaultDate]="maxDate" [maxDate]="maxDate" [minDate]="minDate" dateFormat="dd/mm/yy"
                    [ngClass]="{'lib-invalid': editInfoForm.get('fecha_nacimiento')?.touched && editInfoForm.get('fecha_nacimiento')?.invalid}">
                    </p-calendar>
                </div>
                <div class="input__group">
                    <label>Temas literarios</label>
                    <p-multiSelect display="chip" [selectionLimit]="3" [options]="bookGenres" optionLabel="genero" formControlName="preferencias"
                    [ngClass]="{'lib-invalid': editInfoForm.get('preferencias')?.touched && editInfoForm.get('preferencias')?.invalid}"></p-multiSelect>
                </div>
            </div>
        </div>
        <div class="form__submit flex-container" style="--flex-direction: column;">
            <button class="lib-button" type="submit" [ngClass]="{'lib-button-disabled': !editInfoForm.valid}" 
            [disabled]="!editInfoForm.valid">
                Guardar
            </button>
        </div>
    </form>


    <form class="edit-info__form" [formGroup]="editPassword" (ngSubmit)="onSubmitPass()">
        <p class="edit-msg">Cambiar Contraseña</p>
        <div class="form__group  flex-container">
            <div class="form__data flex-container" style="--flex-direction: column">
                <div class=" input__group">
                    <label>Ingresa tu Contraseña actual </label>
                    <input pInputText type="password" formControlName="clave_actual"
                    [ngClass]="{'lib-invalid': editPassword.get('clave_actual')?.touched && editPassword.get('clave_actual')?.invalid}">
                </div>
            </div>
            <div class="form__data flex-container" style="--flex-direction: column">
                <div class="input__group">
                    <label>Ingresa tu nueva Contraseña </label>
                    <input pInputText type="password" formControlName="clave"
                    [ngClass]="{'lib-invalid': editPassword.get('clave')?.touched && editPassword.get('clave')?.invalid}">
                </div>
                <div class="input__group">
                    <label>Confirma tu nueva Contraseña </label>
                    <input pInputText type="password" formControlName="confirmar-clave"
                    [ngClass]="{'lib-invalid': editPassword.get('confirmar-clave')?.touched && editPassword.get('confirmar-clave')?.invalid}">
                </div>
            </div>
        </div>
        <div class="form__submit flex-container" style="--flex-direction: column;">
            <button class="lib-button" type="submit" [ngClass]="{'lib-button-disabled': !editPassword.valid}" 
            [disabled]="!editPassword.valid">
                Guardar
            </button>

            @if (editPassword.get('clave')?.value !== editPassword.get('confirmar-clave')?.value){
                <p class="lib-invalid__message">Las contraseñas deben coincidir.</p>
            }
        </div>
    </form>
</div>